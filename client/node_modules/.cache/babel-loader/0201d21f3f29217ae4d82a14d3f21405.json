{"ast":null,"code":"import { takeLatest, put, call, all } from 'redux-saga/effects';\nimport { createProfile, auth, provider, getCurrentUser } from '../../FireBase/firebase.utils';\nimport { signInFail, signInSuccess, signOutSuccess, signOutFail } from './user.actions';\nimport { UserActionTypes } from './user.types';\nexport function* checkAuth(user) {\n  try {\n    const userRef = yield call(createProfile, user);\n    const usersnap = yield userRef.get();\n    yield put(signInSuccess({\n      id: usersnap.id,\n      ...usersnap.data()\n    }));\n  } catch (err) {\n    yield put(signInFail(err));\n  }\n}\nexport function* signInGoogle() {\n  try {\n    const {\n      user\n    } = yield auth.signInWithPopup(provider);\n    yield checkAuth(user);\n  } catch (err) {\n    yield put(signInFail(err));\n  }\n}\nexport function* signInGoogleStart() {\n  yield takeLatest(UserActionTypes.GOOGLE_SIGN_IN_START, signInGoogle);\n}\nexport function* signInEmail({\n  payload: {\n    email,\n    password\n  }\n}) {\n  try {\n    const {\n      user\n    } = yield auth.signInWithEmailAndPassword(email, password);\n    yield checkAuth(user);\n  } catch (err) {\n    yield put(signInFail(err));\n  }\n}\nexport function* signInEmailStart() {\n  yield takeLatest(UserActionTypes.EMAIL_SIGN_IN_START, signInEmail);\n}\nexport function* isUserAuth() {\n  try {\n    const userAuth = yield getCurrentUser();\n    if (!userAuth) return;\n    yield checkAuth(userAuth);\n  } catch (err) {\n    yield put(signInFail(err));\n  }\n}\nexport function* onCheckUserSession() {\n  yield takeLatest(UserActionTypes.CHECK_USER_SESSION, isUserAuth);\n}\nexport function* signout() {\n  try {\n    yield auth.signOut();\n    yield put(signOutSuccess());\n  } catch (err) {\n    yield put(signOutFail(err));\n  }\n}\nexport function* onSignOutStart() {\n  yield takeLatest(UserActionTypes.SIGN_OUT_START, signout);\n}\nexport function* userSagas() {\n  yield all([call(signInGoogleStart), call(signInEmailStart), call(onCheckUserSession), call(onSignOutStart)]);\n}","map":{"version":3,"sources":["C:/Users/Manas/Desktop/Btech/web pr/shopnrock/src/Redux/UserReducer/user.saga.js"],"names":["takeLatest","put","call","all","createProfile","auth","provider","getCurrentUser","signInFail","signInSuccess","signOutSuccess","signOutFail","UserActionTypes","checkAuth","user","userRef","usersnap","get","id","data","err","signInGoogle","signInWithPopup","signInGoogleStart","GOOGLE_SIGN_IN_START","signInEmail","payload","email","password","signInWithEmailAndPassword","signInEmailStart","EMAIL_SIGN_IN_START","isUserAuth","userAuth","onCheckUserSession","CHECK_USER_SESSION","signout","signOut","onSignOutStart","SIGN_OUT_START","userSagas"],"mappings":"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","sourcesContent":["import {takeLatest,put, call,all} from 'redux-saga/effects';\r\nimport {createProfile,auth,provider,getCurrentUser} from '../../FireBase/firebase.utils';\r\nimport {signInFail,signInSuccess,signOutSuccess,signOutFail} from './user.actions';\r\nimport {UserActionTypes} from './user.types';\r\nexport function* checkAuth (user) {\r\n    try{\r\n        const userRef= yield call(createProfile,user);\r\n        const usersnap = yield userRef.get();\r\n        yield put(signInSuccess({id:usersnap.id,...usersnap.data()}));\r\n    }\r\n    catch(err){\r\n        yield put(signInFail(err));\r\n    }\r\n}\r\n\r\nexport function* signInGoogle(){\r\n    try{\r\n        const {user}=yield auth.signInWithPopup(provider);\r\n        yield checkAuth(user);\r\n    }\r\n    catch(err){\r\n        yield put(signInFail(err));\r\n    }\r\n}\r\n\r\nexport function* signInGoogleStart () {\r\n    yield takeLatest(UserActionTypes.GOOGLE_SIGN_IN_START,signInGoogle);\r\n}\r\n\r\nexport function* signInEmail({payload:{email,password}}) {\r\n    try{\r\n        const {user}=yield auth.signInWithEmailAndPassword(email,password);\r\n        yield checkAuth(user);\r\n    }\r\n    catch(err){\r\n        yield put(signInFail(err));\r\n    }\r\n}\r\n\r\nexport function* signInEmailStart (){\r\n    yield takeLatest(UserActionTypes.EMAIL_SIGN_IN_START,signInEmail);\r\n}\r\n\r\nexport function* isUserAuth () {\r\n    try{\r\n        const userAuth = yield getCurrentUser();\r\n        if(!userAuth) return;\r\n        yield checkAuth(userAuth);\r\n    }\r\n    catch(err){\r\n        yield put(signInFail(err));\r\n    }\r\n}\r\n\r\nexport function* onCheckUserSession () {\r\n    yield takeLatest(UserActionTypes.CHECK_USER_SESSION,isUserAuth);\r\n}\r\n\r\nexport function* signout () {\r\n    try{\r\n        yield auth.signOut();\r\n        yield put(signOutSuccess());\r\n    }\r\n    catch(err){\r\n        yield put(signOutFail(err));\r\n    }\r\n}\r\n\r\nexport function* onSignOutStart () {\r\n    yield takeLatest(UserActionTypes.SIGN_OUT_START,signout);\r\n}\r\n\r\nexport function* userSagas () {\r\n    yield all([call(signInGoogleStart),call(signInEmailStart),call(onCheckUserSession),call(onSignOutStart)]);\r\n}"]},"metadata":{},"sourceType":"module"}